#!/bin/bash
################################################################################
# A sentence or two about the script
################################################################################

source /etc/odoo/odoo.tools

##

usage() { echo "Usage: $0 [-h <host>]" 1>&2; exit 1; }
#[ -f /etc/odoo/odoo.tools ] && . /etc/odoo/odoo.tools

##
local OPTIND
local OPTARG
local option
while getopts ":h:" option; do
    case $option in
        h) HOST=${OPTARG} ; echo "Host: $option $OPTARG" ;;
        \:) echo "Option $option requires an argument" ; return ;;
        \?) echo "Illegal argument ${option}::${OPTARG}" ; return ;;
    esac
done
if [ ! -z "$ODOOADDONS" ]; then
    for p in ${ODOOADDONS//,/ }; do
        echo -n $p " "
        sudo chown odoo:odoo $p -R
        rsync -ar --delete --exclude='.git/' $p $HOST:$ADDONS_PATH_PREFIX
    done
fi

##
exit 0 # Success
